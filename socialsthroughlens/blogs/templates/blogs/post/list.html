{% extends "blogs/base.html" %}
{% load blog_tags %}

{% block title %}My Blog{% endblock %}

{% block content %}
<div class='border'>
        <p class='MyBlogs'>Blogs</p>
        {% if tag %}
            <h2>Posts tagged with "{{tag.name}}"</h2>
        {% endif %}
        {% for post in posts %}
        <div class='post_detail'>
            <a class='post_link' href="{{post.get_absolute_url}}">
                {{post.title}}
            </a>
        </div>
        <p class='tags'>Tags 
            {% for tag in post.tags.all %}
            <a class='tag_url' href="{% url 'blogs:post_list_by_tag' tag.slug %}">
                {{tag.name}}
            </a>{% if not forloop.last%}, {%endif%}
            {% endfor %}
        </p>
        <p class='date'>
        Published  by {{post.author}} on {{post.publish}}
        {{post.body|markdown|truncatechars_html:80}}
        {{linebreaks}}
        ---------------------------------------------------------------------------------
        </p>
        {% endfor %}
        {% include "pagination.html" with page=posts %}
</div>
<div class='sidebar'>
    <p class='no_of_posts'>I've written {% total_posts %} posts so far.</p>
    <p>
    </p>
    <h3 class="LatestPosts">Latest Posts</h3>
    {% show_latest_posts 3 %}
    <h3 class='Most_comments'>Most Commented Posts</h3>
    {% get_most_commented_posts as most_commented_posts%}
    <ul class='most_commented'>
        {% for post in most_commented_posts %}
        <li>
            <a href="{{post.get_absolute_url}}">{{post.title}}</a>
        </li>
        {% endfor %}
    </ul>
    <a href="{% url 'blogs:post_search' %}" class='button'>Search</a>
</div>
{% endblock %}